"$schema" = "https://jj-vcs.github.io/jj/latest/config-schema.json"

[user]
name = "Mike Skalnik"
email = "mike@skalnik.com"

[signing]
behavior = "own"
backend = "gpg"
key = "mike@skalnik.com"

[signing.backends.ssh]
program = "/Applications/1Password.app/Contents/MacOS/op-ssh-sign"

[ui]
default-command = "log"
diff-editor = ":builtin"

[git]
push-new-bookmarks = true

[colors]
"diff token" = { underline = false }
"diff removed token" = { fg = "black", bg = "red", underline = false }
"diff added token" = { fg = "black", bg = "green", underline = false }

# Stolen from https://zerowidth.com/2025/jj-tips-and-tricks/#bookmarks-and-branches
[aliases]
tug = ["bookmark", "move", "--from", "closest_bookmark(@-)", "--to", "@-"]
xl = ["log", "-r", 'all()']

[revset-aliases]
"closest_bookmark(to)" = "heads(::to & bookmarks())"
'immutable_heads()' = "builtin_immutable_heads() | remote_bookmarks()"

[templates]
git_push_bookmark = '"skalnik/push-" ++ change_id.short()' 
# Stolen from @wfarr ðŸ¥°
# git commit --verbose, kinda:
draft_commit_description = '''
concat(
  description,
  surround(
    "\nJJ: This commit contains the following changes:\n", "",
    indent("JJ:     ", diff.stat(72)),
  ),
  "\nJJ: ignore-rest\n",
  diff.git(),
)
'''
