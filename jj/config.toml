"$schema" = "https://jj-vcs.github.io/jj/latest/config-schema.json"

[user]
name = "Mike Skalnik"
email = "mike@skalnik.com"

[signing]
behavior = "own"
backend = "gpg"
key = "mike@skalnik.com"

[signing.backends.ssh]
program = "/Applications/1Password.app/Contents/MacOS/op-ssh-sign"

[ui]
default-command = "log"
diff-editor = ":builtin"

[git]
push-new-bookmarks = true

[colors]
"diff token" = { underline = false }
"diff removed token" = { fg = "ansi-color-16", bg = "ansi-color-214" }
"diff added token" = { fg = "ansi-color-16", bg = "ansi-color-189" }

# Stolen from https://zerowidth.com/2025/jj-tips-and-tricks/#bookmarks-and-branches
[aliases]
tug = ["bookmark", "move", "--from", "closest_bookmark(@-)", "--to", "@-"]
xl = ["log", "-r", 'all()']
ff = ["rebase", "-s", "roots(trunk()..@)", "-d", "trunk()"]
mm = ["rebase", "-s", "megamerge", "-A", "in_megamerge" ]

[revset-aliases]
"closest_bookmark(to)" = "heads(::to & bookmarks())"
"in_merge(merge)" = "merge- ~ ::trunk()"
"megamerge" = "description('[merge]')"
"in_megamerge" = "in_merge(megamerge)"

[templates]
git_push_bookmark = '"skalnik/push-" ++ change_id.short()' 
# Stolen from @wfarr ðŸ¥°
# git commit --verbose, kinda:
draft_commit_description = '''
concat(
  description,
  surround(
    "\nJJ: This commit contains the following changes:\n", "",
    indent("JJ:     ", diff.stat(72)),
  ),
  "\nJJ: ignore-rest\n",
  diff.git(),
)
'''

[fix.tools.ruff]
command = ["/usr/bin/env ruff", "format", "$path"]
patterns = ["glob:'**/*.py'"]
